{% extends "base.html" %}

{% block title %}Film Discovery - Discover Great Movies{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero maoyan-gradient">
    <div class="hero-background">
        <!-- Film strip background effect -->
        <div class="film-strip">
            <div class="film-frame"></div>
            <div class="film-frame"></div>
            <div class="film-frame"></div>
            <div class="film-frame"></div>
            <div class="film-frame"></div>
        </div>

        <!-- Dynamic background particles -->
        <div class="particles">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>
    </div>

    <div class="hero-content">
        <div class="hero-text">
            <h1 class="hero-title">
                <span class="title-main">Discover Great Movies</span>
                <span class="title-sub">Film Discovery</span>
            </h1>
            <p class="hero-description">
                Explore the wonderful world of cinema and discover your movie treasures. Find films that perfectly match your taste through intelligent recommendations.
            </p>
        </div>

        <div class="hero-actions">
            <a href="{{ url_for('film.list_films') }}" class="btn btn-primary btn-large">
                <i class="fas fa-play"></i>
                Start Browsing
            </a>
            {% if not current_user.is_authenticated %}
            <a href="{{ url_for('auth.register') }}" class="btn btn-outline btn-large">
                <i class="fas fa-user-plus"></i>
                Sign Up Now
            </a>
            {% endif %}
        </div>

        <!-- Statistics -->
        <div class="hero-stats">
            <div class="stat-item">
                <span class="stat-number">{{ films|length }}</span>
                <span class="stat-label">Movies</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">55</span>
                <span class="stat-label">Classics</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">âˆž</span>
                <span class="stat-label">Possibilities</span>
            </div>
        </div>
    </div>
</section>

<!-- Featured Movies Section -->
<section class="featured-section fade-in-section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-star"></i>
                Popular Movies
            </h2>
            <p class="section-description">Curated high-rated movies for your best viewing experience</p>
        </div>

{% if films %}
            <div class="films-grid featured-grid modern-grid">
            {% for film in films[:6] %}
            <div class="film-card featured-card advanced-hover" data-film-id="{{ film.id }}" data-href="{{ url_for('film.film_detail', film_id=film.id) }}">
                <div class="film-poster">
                    {% if film.poster_url %}
                        {% if film.poster_url.startswith('http') or film.poster_url.startswith('//') %}
                            <img src="{{ film.poster_url }}" alt="{{ film.title }} poster" loading="lazy">
                        {% else %}
                            <img src="{{ url_for('static', filename='posters/' ~ film.poster_url) }}" alt="{{ film.title }} poster" loading="lazy">
                        {% endif %}
                        <div class="film-overlay">
                            <div class="overlay-content">
                                <a href="{{ url_for('film.film_detail', film_id=film.id) }}" class="btn btn-primary btn-sm">
                                    <i class="fas fa-eye"></i>
                                    View Details
                                </a>
                            </div>
                        </div>
                    {% else %}
                        <div class="no-poster">
                            <i class="fas fa-film"></i>
                            <span>No poster</span>
                        </div>
                    {% endif %}
                    <!-- Rating badge -->
                    {% if film.average_rating > 0 %}
                    <div class="rating-badge">
                        <i class="fas fa-star"></i>
                        <span>{{ "%.1f"|format(film.average_rating) }}</span>
                    </div>
                    {% endif %}
                    <!-- Like button and count -->
                    <div class="card-actions" style="position:absolute; left:12px; bottom:12px; z-index:5;">
                        {% set liked = (current_user.is_authenticated and film.id in liked_ids) %}
                        <button class="btn btn-outline btn-like {% if liked %}liked{% endif %}" data-film-id="{{ film.id }}" aria-pressed="{{ 'true' if liked else 'false' }}">
                            <i class="fas fa-heart"></i> <span class="sr-only">Like</span>
                        </button>
                        <span data-like-count="{{ film.id }}" class="like-count" style="margin-left:8px;color:white;font-weight:600">{{ film.like_count }}</span>
                    </div>
                </div>

                <div class="film-info">
                    <h3>
                        <a href="{{ url_for('film.film_detail', film_id=film.id) }}" class="film-title-link">
                            {{ film.title }}
                        </a>
                    </h3>

                    <div class="film-meta">
                        {% if film.year %}<span class="meta-item">{{ film.year }}</span>{% endif %}
                        {% if film.genre %}<span class="meta-item">{{ film.genre }}</span>{% endif %}
                        {% if film.director %}<span class="meta-item">{{ film.director }}</span>{% endif %}
                    </div>

                    <div class="film-stats">
                        <span class="stat-item">
                            <i class="fas fa-heart"></i>
                            {{ film.like_count }}
                        </span>
                    </div>

                    {% if film.description %}
                    <p class="film-description">{{ film.description[:80] }}{% if film.description|length > 80 %}...{% endif %}</p>
                    {% endif %}
                </div>
            </div>
    {% endfor %}
        </div>

        <div class="section-footer">
            <a href="{{ url_for('film.list_films') }}" class="btn btn-outline">
                <i class="fas fa-arrow-right"></i>
                    View All Movies
            </a>
        </div>
{% else %}
        <div class="empty-state">
            <i class="fas fa-film"></i>
            <h3>No movie data available</h3>
            <p>We are working hard to add more amazing movies...</p>
        </div>
{% endif %}
    </div>
</section>

<!-- Features section -->
<section class="features-section fade-in-section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-magic"></i>
                Why Choose Us
            </h2>
        </div>

        <div class="features-grid">
            <div class="feature-card modern-card" data-href="{{ url_for('film.recommendations') }}">
                <div class="feature-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h3>Smart Recommendations</h3>
                <p>Intelligent recommendations based on your viewing preferences</p>
                <a href="{{ url_for('film.recommendations') }}" class="btn btn-outline" style="margin-top:12px;">View My Recommendations</a>
            </div>

            <div class="feature-card modern-card" data-href="{{ url_for('film.list_films') }}">
                <div class="feature-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3>Community Interaction</h3>
                <p>Share movie experiences and exchange opinions with fellow film enthusiasts</p>
                <a href="{{ url_for('film.list_films') }}" class="btn btn-outline" style="margin-top:12px;">Browse Movies</a>
            </div>

            <div class="feature-card modern-card" data-href="{{ url_for('film.list_films') }}">
                <div class="feature-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3>Precise Search</h3>
                <p>Multiple filter conditions to quickly find your favorite movies</p>
                <a href="{{ url_for('film.list_films') }}" class="btn btn-outline" style="margin-top:12px;">Start Searching</a>
            </div>

            <div class="feature-card modern-card" data-href="{{ url_for('film.list_films') }}">
                <div class="feature-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h3>Mobile First</h3>
                <p>Perfectly adapted for mobile devices, discover great movies anytime, anywhere</p>
                <a href="{{ url_for('film.list_films') }}" class="btn btn-outline" style="margin-top:12px;">Browse on Mobile</a>
            </div>
        </div>
    </div>
</section>

{% endblock %}
